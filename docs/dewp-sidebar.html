<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DEWP – Sidebar</title>
  <link rel="stylesheet" href="https://unpkg.com/designbase-wp-library@latest/dist/css/dewp.min.css" />
  <link rel="stylesheet" href="./src/_examples-shell.css" />
</head>

<body class="ex-demo-sidebar">

  <div class="ex-main" style="padding: 16px;">
    <div class="ex-section">
      <div class="ex-section-header">
        <div class="ex-section-title-area">
          <h3 class="ex-section-title">사이드바</h3>
          <p class="ex-section-description">타입(basic/wrapper)과 포지션(fixed/sticky/static) 예시</p>
        </div>
      </div>
      <div class="ex-section-content">
        <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-bottom:12px;">
          <label>타입:
            <select id="sidebarType">
              <option value="basic">basic</option>
              <option value="wrapper">wrapper</option>
            </select>
          </label>
          <label>포지션:
            <select id="sidebarPosition">
              <option value="fixed">fixed</option>
              <option value="sticky">sticky</option>
              <option value="static">static</option>
            </select>
          </label>
          <label>top(px):
            <input id="sidebarTop" type="number" value="0" style="width:80px;" />
          </label>
          <label>width(px):
            <input id="sidebarWidth" type="number" value="250" style="width:80px;" />
          </label>
        </div>
        <p>좌측 예시 내비와 겹치지 않도록, 이 데모에서는 콘텐츠 영역(ex-content) 기준으로 사이드바를 표시합니다.</p>
        <p style="margin-top:16px;">본문 스크롤 테스트를 위한 더미 내용</p>
        <div style="height: 1200px"></div>
      </div>
    </div>
    <div class="ex-section">
      <div class="ex-section-header">
        <div class="ex-section-title-area">
          <h3 class="ex-section-title">문서 요약</h3>
          <p class="ex-section-description">Sidebar 핵심 사용 가이드</p>
        </div>
      </div>
      <div class="ex-section-content ex-docs">
        <section>
          <h4>개요</h4>
          <p>워드프레스 관리자용 좌측 고정 내비게이션. 그룹/구분선/서브메뉴를 지원합니다.</p>
        </section>

        <section>
          <h4>생성</h4>
          <pre>
<code class="language-js">const sidebar = new DEWPSidebar({
  title: 'DEWP Admin',
  groups: [{ id: 'general', title: '일반', items: [{ id: 'dashboard', text: '대시보드', url: '#' }] }]
});</code>
          </pre>
        </section>

        <section>
          <h4>API</h4>
          <pre>
<code class="language-js">sidebar.addGroup({ id: 'new', title: '새 그룹', items: [] });
sidebar.addMenuItem('general', { id: 'settings', text: '설정', url: '#' });
sidebar.toggle('tools');
sidebar.destroy();</code>
          </pre>
        </section>

        <section>
          <h4>접근성</h4>
          <ul>
            <li>서브메뉴 토글에 <code>aria-expanded</code>/<code>aria-controls</code> 제공</li>
            <li>서브메뉴는 <code>aria-hidden</code> 상태 업데이트</li>
          </ul>
        </section>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/designbase-wp-library@latest/dist/js/dewp.min.js"></script>
  <script>
    function buildSidebar() {
      const config = {
        title: 'DEWP Admin',
        subtitle: '빠른 이동',
        groups: [
          {
            id: 'general',
            title: '일반',
            items: [
              { id: 'dashboard', text: '대시보드', url: '#', isActive: true },
              { id: 'settings', text: '설정', url: '#' },
              {
                id: 'tools', text: '도구', hasSubmenu: true, submenu: [
                  { id: 'import', text: '가져오기', url: '#' },
                  { id: 'export', text: '내보내기', url: '#' }
                ]
              }
            ]
          },
          {
            id: 'contents',
            title: '콘텐츠',
            items: [
              { id: 'posts', text: '게시글', url: '#' },
              { id: 'pages', text: '페이지', url: '#' },
              { id: 'media', text: '미디어', url: '#' }
            ]
          }
        ],
        footerText: 'DesignBase'
      };
      // 기존 인스턴스 제거 후 재생성
      try { window.__demoSidebar?.destroy(); } catch { }
      window.__demoSidebar = new window.DEWPSidebar(config);
      applySidebarVariants();
    }

    document.addEventListener('DOMContentLoaded', function () {
      if (window.DEWPSidebar) buildSidebar();

      const els = {
        type: document.getElementById('sidebarType'),
        pos: document.getElementById('sidebarPosition'),
        top: document.getElementById('sidebarTop'),
        width: document.getElementById('sidebarWidth')
      };

      function onChange() {
        applySidebarVariants();
      }

      els.type?.addEventListener('change', onChange);
      els.pos?.addEventListener('change', onChange);
      els.top?.addEventListener('input', onChange);
      els.width?.addEventListener('input', onChange);
    });

    function applySidebarVariants() {
      const sidebar = document.querySelector('.dewp-sidebar');
      if (!sidebar) return;

      const type = document.getElementById('sidebarType')?.value || 'basic';
      const pos = document.getElementById('sidebarPosition')?.value || 'fixed';
      const top = parseInt(document.getElementById('sidebarTop')?.value || '0', 10) || 0;
      const width = parseInt(document.getElementById('sidebarWidth')?.value || '250', 10) || 250;

      sidebar.classList.remove('dewp-sidebar--basic', 'dewp-sidebar--wrapper');
      sidebar.classList.add(type === 'wrapper' ? 'dewp-sidebar--wrapper' : 'dewp-sidebar--basic');

      sidebar.classList.remove('is-fixed', 'is-sticky', 'is-static');
      sidebar.classList.add(pos === 'sticky' ? 'is-sticky' : (pos === 'static' ? 'is-static' : 'is-fixed'));

      sidebar.style.setProperty('--dewp-sidebar-top', top + 'px');
      sidebar.style.setProperty('--dewp-sidebar-width', width + 'px');
    }
  </script>

  <script src="./src/_examples-manifest.js"></script>
  <script src="./src/_examples-shell.js"></script>
</body>

</html>