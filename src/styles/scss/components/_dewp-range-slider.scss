/**
 * Range Slider Component
 */
@use "../basic/index" as *;

.dewp-range {
    width: 100%;
    display: inline-block;
    /* 크기 변수 (필요시 인라인 style로 오버라이드 가능) */
    --dewp-track-size: 4px;
    /* 트랙 두께 */
    --dewp-thumb-size: 18px;
    /* 조절 원 지름 */
    --dewp-thumb-shift-y: 0px;
    /* 미세 수직보정 (사파리 -1px 같은) */
    --dewp-range-fill: 0%;
    --dewp-range-start: 0%;
    --dewp-range-end: 100%;
    position: relative;

    .dewp-range-track {
        position: relative;
        height: calc(var(--dewp-thumb-size) + #{$margin-s} * 2); // 썸이 들어갈 세로 공간
    }

    input[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: var(--dewp-thumb-size);
        /* 썸 높이만큼 공간 확보 */
        background: transparent;
        /* 실제 트랙은 pseudo가 그림 */
        border-radius: $radius-2;
        outline: none;
        padding: 0;
        margin: $margin-s 0;

        /* 트랙 */
        &::-webkit-slider-runnable-track {
            height: var(--dewp-track-size);
            border-radius: $radius-2;
            /* 가운데 정렬: 트랙은 자동 중앙, 배경만 유지 */
            background: linear-gradient(90deg,
                    $border-02 0 var(--dewp-range-start, 0%),
                    $primary var(--dewp-range-start, 0%) var(--dewp-range-end, var(--dewp-range-fill, 0%)),
                    $border-02 var(--dewp-range-end, var(--dewp-range-fill, 0%)) 100%);
        }

        &::-moz-range-track {
            height: var(--dewp-track-size);
            border-radius: $radius-2;
            background: linear-gradient(90deg,
                    $border-02 0 var(--dewp-range-start, 0%),
                    $primary var(--dewp-range-start, 0%) var(--dewp-range-end, var(--dewp-range-fill, 0%)),
                    $border-02 var(--dewp-range-end, var(--dewp-range-fill, 0%)) 100%);
        }

        /* 썸(조절 원) — 수직 가운데 보정의 핵심 */
        &::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: var(--dewp-thumb-size);
            height: var(--dewp-thumb-size);
            border-radius: 50%;
            background: $primary;
            border: 2px solid $white;
            box-shadow: 0 0 0 2px rgba($primary, 0.25);
            cursor: pointer;
            /* 트랙 대비 썸의 높이 차이를 중앙으로 당김 */
            margin-top: calc((var(--dewp-track-size) - var(--dewp-thumb-size)) / 2 + var(--dewp-thumb-shift-y));
        }

        &::-moz-range-thumb {
            width: var(--dewp-thumb-size);
            height: var(--dewp-thumb-size);
            border-radius: 50%;
            background: $primary;
            border: 2px solid $white;
            box-shadow: 0 0 0 2px rgba($primary, 0.25);
            cursor: pointer;
            /* Firefox는 보정 거의 불필요 */
        }

        &:focus-visible {
            outline: none;
            box-shadow: 0 0 0 3px rgba($primary, .25);
        }
    }

    .dewp-range-value {
        display: inline-block;
        min-width: 2.5rem;
        padding: 0 $padding-s;
        text-align: right;
        font-variant-numeric: tabular-nums;
        color: $text-primary;
    }

    // 라벨과 틱스
    .dewp-range-labels {
        display: flex;
        justify-content: space-between;
        margin-top: $margin-xs;
        font-size: $font-size-xs;
        color: $text-secondary;
    }

    .dewp-range-ticks {
        position: relative;
        height: 8px;
        margin-top: $margin-xs;

        &::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            height: 2px;
            transform: translateY(-50%);
            background: repeating-linear-gradient(to right, $border-02, $border-02 1px, transparent 1px, transparent 10%);
        }
    }

    // 싱글 슬라이더 중앙 정렬과 오프셋
    &:not(.dewp-range--dual) {
        .dewp-range-track input[type="range"] {
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            transform: translateY(calc(-50% + var(--dewp-range-offset-y, 0px)));
        }
    }

    // 듀얼 슬라이더
    &.dewp-range--dual {
        .dewp-range-dual-wrap {
            position: relative;
            height: calc(var(--dewp-thumb-size) + #{$margin-s} * 2);
        }

        input[type="range"] {
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none; // 트랙 클릭 방지, 썸만
            background: transparent;

            &::-webkit-slider-thumb,
            &::-moz-range-thumb {
                pointer-events: auto;
            }
        }
    }
}